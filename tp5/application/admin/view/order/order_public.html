<{include file='./public/header' /}>
  <link rel="stylesheet" href="__STATIC__/../index/layui/css/layui.css">
  <link rel="stylesheet" href="__STATIC__/css/order_list.css">
  <div class="x-nav">
    <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-right: 20px;float:right" href="javascript:location.replace(location.href);"
      title="刷新">
      <i class="layui-icon" style="line-height:30px">ဂ</i>
    </a>
  </div>

  <form class="layui-form" id="cont">
    <!-- 搜索内容 -->
    <div class="layui-form-item">
      <div class="layui-inline">
        <label class="layui-form-label"></label>
        <div class="layui-input-inline">
          <input type="text" name="username" placeholder="收货联系人" autocomplete="off" class="layui-input">
        </div>
      </div>

      <div class="layui-inline">
        <div class="layui-input-inline">
          <input type="text" name="username" placeholder="装货公司名全称" autocomplete="off" class="layui-input">
        </div>
      </div>

      <div class="layui-inline">
        <div class="layui-input-inline">
          <a class="layui-btn cha">搜索</a>
        </div>
      </div>
    </div>



    <!-- 筛选内容 -->
    <div class="layui-row">
      <label class="layui-form-label"></label>
      <input type="checkbox" name="no_money" value="1" lay-skin="primary" lay-filter="port" title="待订舱" checked="">
      <input type="checkbox" name="have_money" value="2" lay-skin="primary" lay-filter="port" title="待派车" checked="">
      <input type="checkbox" name="have_money" value="3" lay-skin="primary" lay-filter="port" title="待装货" checked="">
      <input type="checkbox" name="have_money" value="4" lay-skin="primary" lay-filter="port" title="待报柜号" checked="">
      <input type="checkbox" name="have_money" value="5" lay-skin="primary" lay-filter="port" title="待配船" checked="">
      <input type="checkbox" name="have_money" value="6" lay-skin="primary" lay-filter="port" title="待到港" checked="">
      <input type="checkbox" name="have_money" value="7" lay-skin="primary" lay-filter="port" title="待卸船" checked="">
      <input type="checkbox" name="have_money" value="8" lay-skin="primary" lay-filter="port" title="待收款" checked="">
      <input type="checkbox" name="have_money" value="9" lay-skin="primary" lay-filter="port" title="待送货" checked="">
    </div>
  </form>

  <div class="order_list layui-row">
    <div class="nei layui-col-md12">
      <div class="top">
        <div class="layui-unselect layui-form-checkbox" lay-skin="primary" data-id='1'>
          <i class="layui-icon">&#xe605;</i>
          <span>创建时间: 2018-15-10</span>
        </div>
        <span class="top_ma">
          <span>业务员: 小屋</span>
          <span>船期: 2018-5-20</span>
          <span>海上时效: 5天<span>
          <span>截单时间: 2018-9-12</span>
        </span>
      </div>
      <div class="cen">
        <div class="cen_le layui-col-md12">
          <div class="layui-col-md3">
            <p>订单号:
              <inpu type='text' name="order_num" id='order_num' value='SAD132165646'>
                SAD132165646
            </p>
            <p>船公司/船名/航次: 中远海/NG564/264次</p>
          </div>
          <div class="layui-col-md3">
            <p>收货人:小明 </p>
            <p>货名：给紫</p>
          </div>
          <div class="layui-col-md3">
            <p>航线:天津港-上海港</p>
            <p>箱型*箱量:40GP*2</p>
          </div>
          <div class="layui-col-md2">
            <p class="se">状态：待报柜</p>
            <p class="se">天数:6天</p>
          </div>
        </div>
      </div>

      <div class="fo">
        <a title="修改" onclick="tj('ADF565466','待报柜')" href="javascript:;">确认</a>
        <a title="查看" onclick="x_admin_show('查看','<{:url('admin/OrderProcess/OrderDetail')}>',1000,500)" href="javascript:;">查看订单</a>
        <a title="修改" onclick="x_admin_show('修改','<{:url('admin/OrderProcess/orderSplit')}>',700,300)" href="javascript:;">修改订单</a>
        <a title="删除" onclick="" href="javascript:;">废弃订单</a>
      </div>
    </div>
  </div>


  <!-- 待派车 -->
  <form class="layui-form" id="car">
    <div class="layui-form-item">
      <label class="layui-form-label">车队名</label>
      <div class="layui-input-block">
        <input type="text" name="car_name" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">车牌号</label>
      <div class="layui-input-block">
        <input type="text" name="truck_code" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">司机姓名</label>
      <div class="layui-input-block">
        <input type="text" name="driver_name" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">身份证</label>
      <div class="layui-input-block">
        <input type="text" name="identity" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">手机</label>
      <div class="layui-input-block">
        <input type="text" name="mobile" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>
  </form>

  <!-- 待配船 -->
  <form class="layui-form" id="pei_post">
    <div class="layui-form-item">
      <div class="layui-inline">
        <label class="layui-form-label">港口</label>
        <div class="layui-input-inline" style="width: 100px;">
          <input type="text" name="price_min" placeholder="起始港" autocomplete="off" class="layui-input">
        </div>
        <div class="layui-form-mid">-</div>
        <div class="layui-input-inline" style="width: 100px;">
          <input type="text" name="price_max" placeholder="目的港" autocomplete="off" class="layui-input">
        </div>
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">船名</label>
      <div class="layui-input-block">
        <input type="text" name="truck_code" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">时间</label>
      <div class="layui-input-block">
        <input type="text" name="driver_name" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>
  </form>

  <!-- 待到港 -->
  <form class="layui-form" id="at_port">
    <div class="layui-form-item">
      <label class="layui-form-label">车队名</label>
      <div class="layui-input-block">
        <input type="text" name="car_name" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">车牌号</label>
      <div class="layui-input-block">
        <input type="text" name="truck_code" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">司机姓名</label>
      <div class="layui-input-block">
        <input type="text" name="driver_name" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">身份证</label>
      <div class="layui-input-block">
        <input type="text" name="identity" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">手机</label>
      <div class="layui-input-block">
        <input type="text" name="mobile" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">柜号</label>
      <div class="layui-input-block">
        <input type="text" name="mobile" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">封条号</label>
      <div class="layui-input-block">
        <input type="text" name="mobile" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">收货人</label>
      <div class="layui-input-block">
        <input type="text" name="mobile" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

    <div class="layui-form-item">
      <label class="layui-form-label">装货时间</label>
      <div class="layui-input-block">
        <input type="text" name="mobile" lay-verify="title" autocomplete="off" placeholder="请输入标题" class="layui-input">
      </div>
    </div>

  </form>

  <!-- 待收款 -->
  <form class="layui-form" id="at_mony">
    <div class="layui-form-item">
        <label class="layui-form-label">收款状态</label>
        <div class="layui-input-block">
          <input type="radio" name="mony" value="1" title="月结" checked="">
          <input type="radio" name="mony" value="2" title="压柜">
          <input type="radio" name="mony" value="3" title="现款">
        </div>
      </div>
  </form>
  <!-- <script src="__STATIC__/js/jquery-3.2.1.min.js"></script>  -->
  <script src="__STATIC__/../index/layui/layui.js"></script>


  <!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
  <script>
    $('.cha').click(function(){
      console.log($('#cont').serializeArray());
      $.post(URL,{data:$('#cont').serialize()});//点击搜索提交
    });
    

    function tj(order_num,order_state){
      order_state = '待派车';
      if (order_state == '待订舱') {
        layer.open({
          title: '待订舱'
          ,content: '<div><input type="text" name="order_num" lay-verify="title" autocomplete="off" placeholder="请输入运单号" class="layui-input"></div>'
          ,yes:function(res){
            let zhi = $('input[name="order_num" ]').val();            
            $.get(URL,{order_num:order_num,zhi:zhi},function(res){
              if (res.status) {
                layui.layer.msg('提交成功', {icon: 1,time: 500},function(){
                layer.close(index);
                });
              }else{
                layui.layer.msg('提交失败', {icon: 2,time: 1000});
              }
            })
          }
        }); 
      }else if (order_state == '待派车') {
        layer.open({
          title: '待派车'
          ,content:$('#car')
          ,yes:function(res){
            $.post(URL,{order_num:order_num,data:$('#car').serialize()},function(res){
              if (res.status) {
                layui.layer.msg('提交成功', {icon: 1,time: 500},function(){
                layer.close(index);
                });
              }else{
                layui.layer.msg('提交失败', {icon: 2,time: 1000});
              }
            })
          }
        });
      }else if (order_state == '待装货') {
        layer.open({
          title: '待装货'
          ,content:'<div><input type="text" name="date" id="date" lay-verify="date" placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input"></div>'
          ,yes:function(res){
            $.post(URL,{order_num:order_num,data:$('#car').serialize()},function(res){
              if (res.status) {
                layui.layer.msg('提交成功', {icon: 1,time: 500},function(){
                layer.close(index);
                });
              }else{
                layui.layer.msg('提交失败', {icon: 2,time: 1000});
              }
            })
          }
        });
      }else if (order_state == '待报柜号'){
        $.get(URL,{order_num:order_num},function(res){
          if (res.status) {
            layui.layer.msg('提交成功', {icon: 1,time: 500},function(){
            });
          }else{
            layui.layer.msg('提交失败', {icon: 2,time: 1000});
          }
        })
      }else if (order_state == '待配船'){
        $.get(URL,{order_num:order_num},function(res){
          if (res.status) {
            layui.layer.msg('提交成功', {icon: 1,time: 500},function(){
            });
          }else{
            layui.layer.msg('提交失败', {icon: 2,time: 1000});
          }
        })
      }else if (order_state == '待到港') {
        layer.open({
          title: '待到港'
          ,content:$('#at_port')
          ,yes:function(res){
            $.post(URL,{order_num:order_num,data:$('#at_port').serialize()},function(res){
              if (res.status) {
                layui.layer.msg('提交成功', {icon: 1,time: 500},function(){
                layer.close(index);
                });
              }else{
                layui.layer.msg('提交失败', {icon: 2,time: 1000});
              }
            })
          }
        });
      }else if (order_state == '待卸船'){
        $.get(URL,{order_num:order_num},function(res){
          if (res.status) {
            layui.layer.msg('提交成功', {icon: 1,time: 500},function(){
            });
          }else{
            layui.layer.msg('提交失败', {icon: 2,time: 1000});
          }
        })
      }else if (order_state == '待收款') {
        layer.open({
          title: '待收款'
          ,content:$('#at_mony')
          ,yes:function(res){
            $.post(URL,{order_num:order_num,data:$('#at_port').serialize()},function(res){
              if (res.status) {
                layui.layer.msg('提交成功', {icon: 1,time: 500},function(){
                layer.close(index);
                });
              }else{
                layui.layer.msg('提交失败', {icon: 2,time: 1000});
              }
            })
          }
        });
      }else if (order_state == '带送货'){
        $.get(URL,{order_num:order_num},function(res){
          if (res.status) {
            layui.layer.msg('提交成功', {icon: 1,time: 500},function(){
            });
          }else{
            layui.layer.msg('提交失败', {icon: 2,time: 1000});
          }
        })
      }
    }
  </script>